Я добавил одну модель, чтобы пользователь мог сохранять proxy доступ

model SavedProxy {
id          Int      @id @default(autoincrement())
userId      Int
proxyRoomId String
isDefault   Boolean  @default(false)
user        User     @relation(fields: [userId], references: [id])
createdAt   DateTime @default(now())
updatedAt   DateTime @updatedAt
}


перед сохранением комнаты нужно проверить есть ли она в SavedRoom roomId  и  ProxyAccess  proxyRoomId
если комнаты нет там и там то сохраняется в SavedRoom roomId
если комната есть в SavedRoom roomId то уточняется в диалоговом окне пользователю: такая комната уже существует
если комната есть в ProxyAccess proxyRoomId то комната сохраняется в model SavedProxy proxyRoomId

можно множество комнат создавать в SavedProxy


при загрузке должны показывать все
Сохраненные комнаты:
и
Сохраненные комнаты proxy:


по умолчанию нужно сделать доработку по  isDefault   Boolean  @default(false) в SavedRoom и SavedProxy
можно только установить одно  дефолтное значение для Сохраненные комнаты Сохраненные комнаты proxy:
если выбираем isDefault для SavedProxy то у всех SavedRoom isDefault будет false и на оборот

ЕЩЕ РАЗ для долбоебов, только один чекбокс isDefault может быть true во всех сохраненных полях proxy и целевых

отвечай на русском.

изменяй точечно , указывая что на что изменить

# Соединение
Проблема, когда только загружается страница - соединение происходит мгновенно, когда нажимаешь на кнопки - Покинуть комнату  или Отключить подключение , соединение подключается 20 секунд, снова перезагружаешь, соединение происходит мгновенно.
сделай так чтобы после нажатия кнопок Покинуть комнату  или Отключить подключение новое соединение происходила мгновенно. Сбрось WEBRTC соединение полностью, и при нажатии на Войти в комнату - создавалось каждый раз новое WebRTC соединение.
сделай точечные изменения, укажи что изменить , отвечай на русском.

# Сокет коннект
Описание проблемы
Ошибка Устройство не найдено или доступ запрещен в функции updateServoSettings возникает из-за того, что пользователь, подключающийся через прокси-доступ, пытается обновить настройки устройства (idDevice), но проверка if (!device || device.userId !== userId) не проходит. Это происходит, потому что устройство принадлежит владельцу комнаты, а не пользователю, подключившемуся через прокси, и userId текущего пользователя не совпадает с userId владельца устройства.

Кроме того, запросы POST https://ardua.site:444/ возвращают ошибку 404 (Not Found), что указывает на проблему с маршрутом или сервером, обрабатывающим настройки устройства (вероятно, это сервер ESP32 или Go-сервер, запущенный в docker-go-95).

Ваша задача также включает необходимость отвязки устройства (idDevice) от комнаты при отключении пользователя от WebRTC (через кнопки «Отключить подключение» или «Покинуть комнату»).




