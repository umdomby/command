в iphone13 в горизонтальном положении экраном вертикально (экран смотрит пользователю) если крутить перед собой Y(gamma)
(начиная экран смотрит на пользователя (горизонтальное положение) и начинаем крутить экраном вверх, потом экраном вперед, потом экраном вниз, потом экраном на себя) то есть
4 перехода :
...-87,-88,-89 (переход) 89,88,87...3,2,1,0 (переход)-0,-1,-2...-87,-88,-89 (переход)...89,88,87...3,2,1,0(переход)...-0,-1,-2,-3...
и так по кругу повторяется.

в данном коде мне нужно отправлять данные оси Y (gamma) на servo1 который имеет 180 градусов, а не -88,-87,-88,-89...89,88,87... и другие переходы.
в данном коде есть один рабочий переход (удали его) - это оси Y (gamma) ...3,2,1,0 (переход) -0,-1,-2,-3,... это в сумме получается от 0 до 180 градусов servo1, но 
мне нужно использовать только эти переходы (2 штуки) ...-87,-88,-89 (переход) 89,88,87... чтобы был диапозон для servo1 0-180 градусов.
остальные переходы 2 штуки (...3,2,1,0 (переход)-0,-1,-2...) никак не должны влиять на servo1 (не отправлять данные при этом переходе ...3,2,1,0 (переход)-0,-1,-2...), когда будут случаться остальные ненужные переходы, на servo1 ничего не должно отправляться, отправляться должно:
от -0,-1,-2,-3...-87,-88,-89 (переход) 89,88,87...3,2,1,0 - это для servo1 0-180 градусов.
таких переходов два можешь второй дублировать, но при остальных переходах, на servo1 Ничего не должно отправляться.
должно быть в двух переходах: 
- iphone13 Y(gamma) 0,-1,-2,-3...-87,-88,-89 (переход) 89,88,87...3,2,1,0 отправляем данные в servo1:
- servo1:  0,1,2,3...87,88,89 (переход в iphone13 Y(gamma) ) 90,89,88...3,2,1,0 

отвечай на русском, дай полный код


в этом коде Y(gamma) нужно исправить работу переходов переходе через 0 (3,2,1,0 → -0,-1,-2), этот переход имеет 90 градусов на servo1 - этот переход ничего не должен отправлять на servo1.
Нужно, чтобы работал этот переход Y(gamma) -89/+89 (-87,-88,-89 → 89,88,87 или обратно), и в этом случае servo1 должен масштабироваться от 0 до 180 градусов, с точкой перехода (-89 → 89) соответствующей 90 градусам. 
Все остальные переходы Y(gamma), включая 3,2,1,0 → -0,-1,-2, должны игнорироваться (не отправлять данные на servo1).
### 
в iphone13 в горизонтальном положении экраном вертикально (экран смотрит пользователю) есть
1. когда пользователь положил экран телефона в VirtualBox и его голова смотрит вниз
   на телефоне ось Y : ...3,2,1,0 (переход) -0,-1,-2,-3,... | servo1 ...87,88,89,90 (переход) 90,91,92,93...
   Этот переход работает хорошо
2. когда пользователь положил экран телефона в VirtualBox и его голова находится в нормальном положении, экраном к лицу и его голова начинает смотреть вниз
   на телефоне ось Y : ...-87,-88,-89, (переход) 89,88,87,... | servo1 ...3,2,1,0 (переход) дальше у servo1 градусов нет, поэтому
   после этого перехода на телефоне...-87,-88,-89, (переход) 89,88,87,... на servo1 ничего не должно отправляться, был отправлен последний 0,
   когда вернется состояние ...-87,-88,-89, градусы у servo1 Должны опять восстанваливаться 1,2,3
   этоту логику переходу нужно добавить

3. когда пользователь положил экран телефона в VirtualBox и его голова находится в нормальном положении, экраном к лицу и его голова наклоняется назад (лицо - вверх)
   на телефоне ось Y : 89 | servo1 90
   на телефоне ось Y : 88 | servo1 91
   на телефоне ось Y : 87 | servo1 92 ... до 179 servo1
   когда будет выходить за предел 2,1,0,-0,  -1,-2,-3,-4 то на servo1 отправляем только 180
###
это не правильно: // Масштабируем gamma: [-89, 89] -> [0, 180]
// Точка -89 соответствует 0 градусов на сервоприводе.
// Точка +89 соответствует 180 градусов на сервоприводе.
// Центр (0 градусов gamma) соответствует 90 градусам на сервоприводе.

правильно :
Масштабируем gamma -0,-1,-2,-3...-87,-88,-89 (переход) 89,88,87...3,2,1,0  [0, 0] -> [0, 180]
Точка -89 (переход) 89 соответствует 90 и 91 градусов на сервоприводе.
Точка 0 НОЛЬ -> (-0,-1,-2,-3) НОЛЬ! соответствует 0 градусов на сервоприводе.
Точка 3,2,1,0 НОЛЬ -> соответствует 180 градусов на сервоприводе.
Центр (-89 градусов gamma) соответствует 90 градусам на сервоприводе.

это не правильно: // Если gamma выходит за пределы [-89, 89], данные на servo1 не отправляются.
// Это игнорирует все переходы, кроме желаемого (внутри [-89, 89]),
// включая переход через 0 (3,2,1,0 -> -0,-1,-2) который выходит за этот диапазон.

###
должно быть :
этот диапазон где servo1 = 0 (3,2,1,0 <- -0,-1,-2) игнорируется 3,2,1,0.
этот диапазон где servo1 = 0 (3,2,1,0 -> -0,-1,-2) не игнорируется -0,-1,-2

этот диапазон где servo1 = 177-180 (3,2,1,0 -> -0,-1,-2,-3) игнорируется -0,-1,-2,-3.
этот диапазон где servo1 = 177-180 (3,2,1,0 <- -0,-1,-2) не игнорируется 3,2,1,0.

этот диапазон где servo1 87,88,89,90,91,92 (-87,-88,-89 (переход) 89,88,87...) не игнорируется 89,-89


когда iphone13 выходит за предел servo1 -3,-2,-1 <-0 игнорируем, так же игнорируем 180 -> 181,182,183
но мы не игнорируем -3,-2,-1 -> 0,1,2,3 не игнорируем отправку данных на servo1 0,1,2,3 и не игнорируем отправку данных (178,179,180) на servo1 178,179,180 <- 181,182,183
измени гнорирование
отвечай на русском оставляй и добавляй комментарии

###
мне нужно устанавливать центр на servo1 - это 90 градусов
в iphone13 в горизонтальном положении экраном вертикально (экран смотрит пользователю) если крутить перед собой Y(gamma)
сейчас центр находится в переходе, мне нужно изменить только отправку на servo1 измени логику так (и чтобы я сам потом мог менять в коде это значение) центрирование servo1 смети центр на 90 градусов
отвечай на русском оставляй и добавляй комментарии
###
if (isValidTransition.current && y >= -89 && y <= 89)  по моему я могу ошибаться это условие не дает правильно передавать данные обратно из мертвых зон
должно быть
этот диапазон где servo1 = 0 (3,2,1,0 <- -0,-1,-2) игнорируется 3,2,1,0.
этот диапазон где servo1 = 0 (3,2,1,0 -> -0,-1,-2) не игнорируется -0,-1,-2 не ждать когда будет  y >= -89 && y <= 89 а сразу передавать данные на servo1

этот диапазон где servo1 = 177-180 (3,2,1,0 -> -0,-1,-2,-3) игнорируется -0,-1,-2,-3.
этот диапазон где servo1 = 177-180 (3,2,1,0 <- -0,-1,-2) не игнорируется 3,2,1,0. не ждать когда будет  y >= -89 && y <= 89 а сразу передавать данные на servo1
отвечай на русском оставляй и добавляй комментарии


###
const SERVO1_CENTER = 90;  это значение делает сдвиг градусов относительно  iphone13 Y(gamma) и servo1 0-180 градусов.
когда я устанавливаю const SERVO1_CENTER = 0 , iphone13 Y(gamma) сдвигается относительно servo1 на 90 градусов вперед, 
но диапазон servo1 стал 0-90, 90 градусов пропало, не отправляются команды 90+ на servo1, исправь чтобы при смене SERVO1_CENTER например на 0, 
диапазон у servo1 был весь 0-180 градусов. Чтобы был сдвиг servo1 относительно Y(gamma) , но логика Y(gamma) не изменялась.
отвечай на русском оставляй и добавляй комментарии






























для управления servo1
нужно использовать положение телефона
#define SERVO1_PIN D7 ось серво1 Y 
#define SERVO2_PIN D8 ось серво2 X 

нужно изменить VirtualBox
рассматриваем положение iphone13 где зарядка справа, в горизонтальном положении телефон, экран смотрит человеку в глаза, голова в нормальном положении.
Arduino #define SERVO1_PIN D7 ось серво Y. 
ось Y телефона управляет -  servo1
на ось Y рабочий диапазон телефона от -0, -90, 90, 0
нужно эти параметры преобразовать в 0-180 градусов для серво1
ось Y телефона управляет - servo1
iPhone 13 в горизонтальном положении, экраном к пользователю, зарядка справа.
рабочий диапозон телефона для servo1 должен быть -0, -89, 89, 0
рабочий диапозон серво 0 - 180, где:

должно быть:
когда iphone13 в горизонтальном положении экраном вертикально (экран смотрит пользователю)
1. когда пользователь положил экран телефона в VirtualBox и его голова находится в нормальном положении, экраном к лицу, нет наклонов.
на телефоне ось Y : ...-88,-89 или 89,88... | servo1 ...88,89,90,91...

2. когда пользователь положил экран телефона в VirtualBox и его голова находится в нормальном положении, экраном к лицу и его голова начинает смотреть вниз
на телефоне ось Y : -89 | servo1 89
на телефоне ось Y : -88 | servo1 88
на телефоне ось Y : -87 | servo1 87 ... до 0 servo1
когда будет выходить за предел -2,-1,-0 (тут за предел) 1,2,3,4 то на servo1 отправляем только 0

3. когда пользователь положил экран телефона в VirtualBox и его голова находится в нормальном положении, экраном к лицу и его голова наклоняется назад (лицо - вверх)
на телефоне ось Y : 89 | servo1 90
на телефоне ось Y : 88 | servo1 91
на телефоне ось Y : 87 | servo1 92 ... до 179 servo1
когда будет выходить за предел 2,1,0,-0,  -1,-2,-3,-4 то на servo1 отправляем только 180

###
   Проблемы в этом коде:
1. проблема идет резкий перепад  с -87,-88,-89, ,89 (тут servo1 становится 180),88(тут servo1 становится 179),87(тут servo1 становится 178)  
   iPhone 13 в горизонтальном положении, экраном к пользователю, зарядка справа.
2. iphone13 в горизонтальном положении экраном вертикально (экран смотрит пользователю) , пользователь начинает опускать голову (iphone13 в VirtualBox) то servo1 подымается вверх, нужно чтоюы опускалось вниз

servo1 0-180, 90-0 опускает голову, 90-180 подымает голову, 90 servo1 - это человек смотрит стоя, без наклонов головы прямо в экран.
Отвечай на русском. Дай полный код VirtualBox

###
уже лучше, но у тебя получается работа - зарядка справа и пользователь смотрит вниз , тогда угол servo1 от 0 до 180 градусов работает, нужно  к отправке servo1 Добавить 90 градусов.
инверсию оси gamma

дам для примера JoyAnalog, сервер, и код ардуино . Нужно изменить VirtualBox , оси X и #define SERVO2_PIN D8 // ось X leftStick не трогаем, путь будут закомментированиы


для примера тебе дам JoyAnalog

Так же есть проблема, когда например пользователь заходит за рамки положения головы вверх+ и положения головы вниз+, в этом случае
на серво не должны отправляться обновленные данные. Пример если пользователь поднял голову вверх это ...3,2,1,0 потом начинает -0,-1,-2,-3... в этот момент
на серво ничего не должно отправляться кроме положения оси Y 180 градусов на серво, так же и с положением вниз, ...-3,-2,-1,-0 потом начинает 
заваливаться 0,1,2,3 ... в этом случае на серво отправляется от телефона оси Y только 0

Посмотри чтобы ось Y телефона отправляла только на на серво 1 #define SERVO1_PIN D7 
закомментируй пока параметры которые отправляют данные на #define SERVO2_PIN D8 - servo2
разберемся пока с осью Y

Отвечай на русском.
в этом коде нужно изменить

