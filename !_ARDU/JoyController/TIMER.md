            if (timeSinceSync.TotalMinutes > 10 || timeSinceSync.TotalMinutes < -5)
            {
                lblLicenseStatus.Text = "⛔ Системное время было изменено!\nПерезапустите программу.";
                lblLicenseStatus.ForeColor = Color.Red;
                return;
            }


| Момент                        | Что именно обновляется                              | Как часто          | Где в коде                              |
|-------------------------------|------------------------------------------------------|--------------------|-----------------------------------------|
| При запуске (автологин)       | `trialMinutesRemaining`, `isTrial`, `LastSyncUtc`   | один раз при старте| `Form1_Load` → `UpdateLicenseUIAsync`   |
| При нажатии кнопки "Обновить" | то же самое                                          | вручную            | `btnRefreshLicense.Click`               |
| При успешном heartbeat        | `trialMinutesRemaining` (если trial), `LastSyncUtc` | каждые 60 секунд   | `ReportUsageSafeAsync`                  |
| После успешного логина        | то же самое                                          | при каждом входе   | `BtnLogin_Click`, `ShowLoginFormAndUpdateUI` |

┌─────────────────────┐
│ Программа запущена  │
└──────────┬──────────┘
│
▼
┌─────────────────────────────┐
│ TryLoadSavedLogin()         │  ← если есть сохранённый токен
└──────────┬──────────────────┘
│
▼
┌────────────────────────────────────┐
│ UpdateLicenseUIAsync()             │
│   ↓                                │
│   await ValidateLicenseAsync()     │  ← запрос на сервер /validate
│   ↓                                │
│   license = ответ сервера          │
│   trialMinutesRemaining = license.TrialRemaining
│   isTrial = true (в твоём случае)
│   _licenseService.UpdateLastSyncTime()  ← фиксируем UTC-время прямо сейчас
└────────────────────────────────────┘
│
▼
┌─────────────────────────────┐   каждую секунду
│ licenseTimer →              │
│ UpdateLicenseCountdown()    │
│   ↓                         │
│   elapsedSec = nowUtc - LastSyncUtc
│   remainingSec = trialMinutesRemaining * 60 - elapsedSec
│   показываем чч:мм:сс       │
└─────────────────────────────┘

           │ каждые 60 сек
           ▼
┌─────────────────────────────┐
│ heartbeatTimer →            │
│ ReportUsageSafeAsync()      │
│   ↓                         │
│   await ReportUsageAsync(1) │  ← запрос на сервер /heartbeat
│   ↓                         │
│   if success:               │
│     UpdateLastSyncTime()    │  ← обновляем точку отсчёта
│     if trial:               │
│       trialMinutesRemaining = response.Remaining.Value
│     UpdateLicenseCountdown()│  ← сразу показываем новое значение
└─────────────────────────────┘

Да, в текущей версии твоего проекта сброс триала происходит по локальному времени системы пользователя (по дате на его ПК), а не по серверному времени.
Почему именно так
В эндпоинте /heartbeat (и /validate) сброс триала проверяется так:
TypeScriptconst isNewDay = !license.lastUsageDate ||
license.lastUsageDate.toDateString() !== now.toDateString();

now = new Date() — это время сервера (Node.js всегда в UTC)
license.lastUsageDate — тоже хранится в UTC (DateTime в Prisma)
Но toDateString() — это метод JavaScript, который конвертирует дату в локальную строку по часовому поясу сервера (или в UTC, в зависимости от настроек)

Однако клиент отправляет heartbeat каждые 60 секунд (или когда угодно), и если пользователь изменил системное время/дату на своём ПК — это не влияет на now.toDateString() на сервере.
Кто решает, когда "новый день"?

Сервер решает самостоятельно по своему времени (new Date())
Клиентское время не влияет на сброс
Поэтому сброс триала происходит в 00:00 по UTC (или по времени сервера, где он развёрнут)

Но есть нюанс:

Если пользователь не отправлял heartbeat в момент перехода через полночь → сброс произойдёт при первом запросе после 00:00 по серверу
Если у пользователя нет интернета → сброса не будет, пока он не подключится

Как сейчас выглядит сброс (на практике)

Сервер хранит lastUsageDate в UTC
При каждом heartbeat проверяет toDateString() — это строка вида "Thu Feb 27 2026" в UTC (или локальном поясе сервера)
Если дата изменилась → used = 0, обновляется lastUsageDate = now (UTC)

Итог:
Да, сброс триала происходит по времени сервера (обычно 00:00 UTC), а не по времени пользователя.
Клиентское время/дата не влияет на момент сброса — пользователь не может "открутить" дату назад и получить новый триал.
Если хочешь, чтобы сброс был именно по локальному времени пользователя (по его часовому поясу) — это можно сделать, но тогда защита от манипуляций временем станет слабее.
Сейчас у тебя безопасный вариант — сброс по серверу.